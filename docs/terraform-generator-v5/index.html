<!DOCTYPE html><html class="default"><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="IE=edge"/><title>terraform-generator - v5</title><meta name="description" content="Documentation for terraform-generator - v5"/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="stylesheet" href="assets/style.css"/><link rel="stylesheet" href="assets/highlight.css"/><script async src="assets/search.js" id="search-script"></script></head><body><script>document.body.classList.add(localStorage.getItem("tsd-theme") || "os")</script><header><div class="tsd-page-toolbar"><div class="container"><div class="table-wrap"><div class="table-cell" id="tsd-search" data-base="."><div class="field"><label for="tsd-search-field" class="tsd-widget search no-caption">Search</label><input type="text" id="tsd-search-field"/></div><ul class="results"><li class="state loading">Preparing search index...</li><li class="state failure">The search index is not available</li></ul><a href="index.html" class="title">terraform-generator - v5</a></div><div class="table-cell" id="tsd-widgets"><div id="tsd-filter"><a href="#" class="tsd-widget options no-caption" data-toggle="options">Options</a><div class="tsd-filter-group"><div class="tsd-select" id="tsd-filter-visibility"><span class="tsd-select-label">All</span><ul class="tsd-select-list"><li data-value="public">Public</li><li data-value="protected">Public/Protected</li><li data-value="private" class="selected">All</li></ul></div> <input type="checkbox" id="tsd-filter-inherited" checked/><label class="tsd-widget" for="tsd-filter-inherited">Inherited</label><input type="checkbox" id="tsd-filter-externals" checked/><label class="tsd-widget" for="tsd-filter-externals">Externals</label></div></div><a href="#" class="tsd-widget menu no-caption" data-toggle="menu">Menu</a></div></div></div></div><div class="tsd-page-title"><div class="container"><h1>terraform-generator - v5 </h1></div></div></header><div class="container container-main"><div class="row"><div class="col-8 col-content"><div class="tsd-panel tsd-typography">
<a href="#terraform-generator" id="terraform-generator" style="color: inherit; text-decoration: none;">
  <h1><strong>terraform-generator</strong></h1>
</a>
<p><a href="https://www.npmjs.com/package/terraform-generator"><img src="https://img.shields.io/npm/v/terraform-generator" alt="npm package"></a>
<a href="https://www.npmjs.com/package/terraform-generator"><img src="https://img.shields.io/npm/dt/terraform-generator" alt="npm downloads"></a>
<a href="https://github.com/ahzhezhe/terraform-generator"><img src="https://github.com/ahzhezhe/terraform-generator/workflows/test/badge.svg?branch=master" alt="GitHub test"></a>
<a href="https://github.com/ahzhezhe/terraform-generator/issues"><img src="https://img.shields.io/github/issues/ahzhezhe/terraform-generator" alt="GitHub issues"></a>
<a href="https://github.com/ahzhezhe/terraform-generator/blob/master/LICENSE"><img src="https://img.shields.io/github/license/ahzhezhe/terraform-generator" alt="GitHub license"></a></p>
<p>Use Node.js to generate Terraform configurations.</p>
<p>You do not need to have Terraform installed to use this module.</p>
<p>The end result of using this module is Terraform configurations in plain text, you will need to write the text  into a file (terraform-generator does provide an utility function to write the file for you) and execute it yourself.</p>
<p>Currently support generating configurations for Terraform version &gt;= 0.12.</p>
<p><a href="https://ahzhezhe.github.io/docs/terraform-generator-v5/index.html">API Documentation</a></p>

<a href="#benefit" id="benefit" style="color: inherit; text-decoration: none;">
  <h2><strong>Benefit</strong></h2>
</a>
<p>Make use of all Javascript programming features (some of which is not available in Terraform), e.g. functions, array, loops, if-else, map, etc. to generate a plain Terraform configurations.</p>
<p>You can easily maintain your infra in Javascript/Typescript.</p>
<p>You don&#39;t need to use Terraform variables, you can use your own Javascript/JSON variables or use dotenv.</p>
<p>You don&#39;t need to use Terraform modules for reusable resource creations, you can make use of Javascript functions.</p>
<p>You can incorporate other Node.js libraries to facilitate your work.</p>

<a href="#limitation" id="limitation" style="color: inherit; text-decoration: none;">
  <h2><strong>Limitation</strong></h2>
</a>
<p>The generated configurations are unformatted and its validity is not verified, use <code>terraform fmt</code> and <code>terraform plan</code> to format it and check its validity yourself.</p>

<a href="#install-via-npm" id="install-via-npm" style="color: inherit; text-decoration: none;">
  <h2><strong>Install via NPM</strong></h2>
</a>
<pre><code><span class="hl-0">npm</span><span class="hl-1"> </span><span class="hl-0">install</span><span class="hl-1"> </span><span class="hl-0">terraform</span><span class="hl-1">-</span><span class="hl-0">generator</span>
</code></pre>

<a href="#usage" id="usage" style="color: inherit; text-decoration: none;">
  <h2><strong>Usage</strong></h2>
</a>

<a href="#import" id="import" style="color: inherit; text-decoration: none;">
  <h3><strong>Import</strong></h3>
</a>
<pre><code class="language-javascript"><span class="hl-2">import</span><span class="hl-1"> { </span><span class="hl-0">TerraformGenerator</span><span class="hl-1">, </span><span class="hl-0">Resource</span><span class="hl-1">, </span><span class="hl-0">map</span><span class="hl-1">, </span><span class="hl-0">fn</span><span class="hl-1"> } </span><span class="hl-2">from</span><span class="hl-1"> </span><span class="hl-3">&#39;terraform-generator&#39;</span><span class="hl-1">;</span>
</code></pre>
<p>or</p>
<pre><code class="language-javascript"><span class="hl-4">const</span><span class="hl-1"> { </span><span class="hl-5">TerraformGenerator</span><span class="hl-1">, </span><span class="hl-5">Resource</span><span class="hl-1">, </span><span class="hl-5">map</span><span class="hl-1">, </span><span class="hl-5">fn</span><span class="hl-1"> } = </span><span class="hl-6">require</span><span class="hl-1">(</span><span class="hl-3">&#39;terraform-generator&#39;</span><span class="hl-1">);</span>
</code></pre>

<a href="#initialize-terraformgenerator" id="initialize-terraformgenerator" style="color: inherit; text-decoration: none;">
  <h3><strong>Initialize TerraformGenerator</strong></h3>
</a>
<pre><code class="language-javascript"><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-5">tfg</span><span class="hl-1"> = </span><span class="hl-4">new</span><span class="hl-1"> </span><span class="hl-6">TerraformGenerator</span><span class="hl-1">({</span><br/><span class="hl-1">  </span><span class="hl-0">required_version:</span><span class="hl-1"> </span><span class="hl-3">&#39;&gt;= 0.12&#39;</span><br/><span class="hl-1">});</span>
</code></pre>

<a href="#blocks" id="blocks" style="color: inherit; text-decoration: none;">
  <h3><strong>Blocks</strong></h3>
</a>
<p>Block&#39;s arguments are not typed, please refer to official Terraform documentation on what arguments can be supplied.</p>
<pre><code class="language-javascript"><span class="hl-0">tfg</span><span class="hl-1">.</span><span class="hl-6">provider</span><span class="hl-1">(</span><span class="hl-3">&#39;aws&#39;</span><span class="hl-1">, {</span><br/><span class="hl-1">  </span><span class="hl-0">region:</span><span class="hl-1"> </span><span class="hl-3">&#39;ap-southeast-1&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-0">profile:</span><span class="hl-1"> </span><span class="hl-3">&#39;example&#39;</span><br/><span class="hl-1">});</span><br/><br/><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-5">vpc</span><span class="hl-1"> = </span><span class="hl-0">tfg</span><span class="hl-1">.</span><span class="hl-6">resource</span><span class="hl-1">(</span><span class="hl-3">&#39;aws_vpc&#39;</span><span class="hl-1">, </span><span class="hl-3">&#39;vpc&#39;</span><span class="hl-1">, {</span><br/><span class="hl-1">  </span><span class="hl-0">cidr_block:</span><span class="hl-1"> </span><span class="hl-3">&#39;172.88.0.0/16&#39;</span><br/><span class="hl-1">});</span>
</code></pre>

<a href="#convert-resource-to-data-source" id="convert-resource-to-data-source" style="color: inherit; text-decoration: none;">
  <h3><strong>Convert resource to data source</strong></h3>
</a>
<pre><code class="language-javascript"><span class="hl-2">import</span><span class="hl-1"> { </span><span class="hl-0">vpc</span><span class="hl-1"> </span><span class="hl-2">as</span><span class="hl-1"> </span><span class="hl-0">vpcDS</span><span class="hl-1"> } </span><span class="hl-2">from</span><span class="hl-1"> </span><span class="hl-3">&#39;other-terraform-generator-configuration&#39;</span><span class="hl-1">;</span><br/><br/><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-5">vpc</span><span class="hl-1"> = </span><span class="hl-0">tfg</span><span class="hl-1">.</span><span class="hl-6">dataFromResource</span><span class="hl-1">(</span><span class="hl-0">vpcDS</span><span class="hl-1">, </span><span class="hl-4">null</span><span class="hl-1">, [</span><span class="hl-3">&#39;cidr_block&#39;</span><span class="hl-1">, [</span><span class="hl-3">&#39;tags&#39;</span><span class="hl-1">, </span><span class="hl-3">&#39;tag&#39;</span><span class="hl-1">]]);</span>
</code></pre>

<a href="#arguments" id="arguments" style="color: inherit; text-decoration: none;">
  <h3><strong>Arguments</strong></h3>
</a>
<pre><code class="language-javascript"><span class="hl-1">{</span><br/><span class="hl-1">  </span><span class="hl-7">string</span><span class="hl-1">: </span><span class="hl-3">&#39;str&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-7">number</span><span class="hl-1">: </span><span class="hl-8">123</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-7">boolean</span><span class="hl-1">: </span><span class="hl-4">true</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-7">stringList</span><span class="hl-1">: [</span><span class="hl-3">&#39;str1&#39;</span><span class="hl-1">, </span><span class="hl-3">&#39;str2&#39;</span><span class="hl-1">, </span><span class="hl-3">&#39;str3&#39;</span><span class="hl-1">],</span><br/><span class="hl-1">  </span><span class="hl-7">numberList</span><span class="hl-1">: [</span><span class="hl-8">111</span><span class="hl-1">, </span><span class="hl-8">222</span><span class="hl-1">, </span><span class="hl-8">333</span><span class="hl-1">],</span><br/><span class="hl-1">  </span><span class="hl-7">booleanList</span><span class="hl-1">: [</span><span class="hl-4">true</span><span class="hl-1">, </span><span class="hl-4">false</span><span class="hl-1">, </span><span class="hl-4">true</span><span class="hl-1">],</span><br/><span class="hl-1">  </span><span class="hl-7">tuple</span><span class="hl-1">: [</span><span class="hl-3">&#39;str&#39;</span><span class="hl-1">, </span><span class="hl-8">123</span><span class="hl-1">, </span><span class="hl-4">true</span><span class="hl-1">],</span><br/><span class="hl-1">  </span><span class="hl-7">object</span><span class="hl-1">: {</span><br/><span class="hl-1">    </span><span class="hl-7">arg1</span><span class="hl-1">: </span><span class="hl-3">&#39;str&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">    </span><span class="hl-7">arg2</span><span class="hl-1">: </span><span class="hl-8">123</span><span class="hl-1">,</span><br/><span class="hl-1">    </span><span class="hl-7">arg3</span><span class="hl-1">: </span><span class="hl-4">true</span><br/><span class="hl-1">  },</span><br/><span class="hl-1">  </span><span class="hl-7">objectList</span><span class="hl-1">: [</span><br/><span class="hl-1">    {</span><br/><span class="hl-1">      </span><span class="hl-0">arg1:</span><span class="hl-1"> </span><span class="hl-3">&#39;str&#39;</span><br/><span class="hl-1">    },</span><br/><span class="hl-1">    {</span><br/><span class="hl-1">      </span><span class="hl-0">arg1:</span><span class="hl-1"> </span><span class="hl-3">&#39;str&#39;</span><br/><span class="hl-1">    }</span><br/><span class="hl-1">  ],</span><br/><span class="hl-1">  </span><span class="hl-7">objectListForVariable</span><span class="hl-1">: </span><span class="hl-6">list</span><span class="hl-1">(</span><br/><span class="hl-1">    {</span><br/><span class="hl-1">      </span><span class="hl-0">arg1:</span><span class="hl-1"> </span><span class="hl-3">&#39;str&#39;</span><br/><span class="hl-1">    },</span><br/><span class="hl-1">    {</span><br/><span class="hl-1">      </span><span class="hl-0">arg1:</span><span class="hl-1"> </span><span class="hl-3">&#39;str&#39;</span><br/><span class="hl-1">    }</span><br/><span class="hl-1">  ),</span><br/><span class="hl-1">  </span><span class="hl-7">map</span><span class="hl-1">: </span><span class="hl-6">map</span><span class="hl-1">({</span><br/><span class="hl-1">    </span><span class="hl-0">arg1:</span><span class="hl-1"> </span><span class="hl-3">&#39;str&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">    </span><span class="hl-0">arg2:</span><span class="hl-1"> </span><span class="hl-8">123</span><span class="hl-1">,</span><br/><span class="hl-1">    </span><span class="hl-0">arg3:</span><span class="hl-1"> </span><span class="hl-4">true</span><br/><span class="hl-1">  }),</span><br/><span class="hl-1">  </span><span class="hl-7">block</span><span class="hl-1">: </span><span class="hl-0">block</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-7">blockAttribute</span><span class="hl-1">: </span><span class="hl-0">block</span><span class="hl-1">.</span><span class="hl-6">attr</span><span class="hl-1">(</span><span class="hl-3">&#39;attrName&#39;</span><span class="hl-1">),</span><br/><span class="hl-1">  </span><span class="hl-7">heredoc</span><span class="hl-1">: </span><span class="hl-6">heredoc</span><span class="hl-1">(</span><span class="hl-3">`line1</span><br/><span class="hl-3">                        line2</span><br/><span class="hl-3">                        line3`</span><span class="hl-1">),</span><br/><span class="hl-1">  </span><span class="hl-7">heredocJson</span><span class="hl-1">: </span><span class="hl-6">heredoc</span><span class="hl-1">({</span><br/><span class="hl-1">    </span><span class="hl-0">arg1:</span><span class="hl-1"> </span><span class="hl-3">&#39;str&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">    </span><span class="hl-0">arg2:</span><span class="hl-1"> </span><span class="hl-8">123</span><span class="hl-1">,</span><br/><span class="hl-1">    </span><span class="hl-0">arg3:</span><span class="hl-1"> </span><span class="hl-4">true</span><br/><span class="hl-1">  }),</span><br/><span class="hl-1">  </span><span class="hl-7">function1</span><span class="hl-1">: </span><span class="hl-6">fn</span><span class="hl-1">(</span><span class="hl-3">&#39;max&#39;</span><span class="hl-1">, </span><span class="hl-8">5</span><span class="hl-1">, </span><span class="hl-8">12</span><span class="hl-1">, </span><span class="hl-8">19</span><span class="hl-1">),</span><br/><span class="hl-1">  </span><span class="hl-7">function2</span><span class="hl-1">: </span><span class="hl-6">fn</span><span class="hl-1">(</span><span class="hl-3">&#39;sort&#39;</span><span class="hl-1">, </span><span class="hl-3">&#39;a&#39;</span><span class="hl-1">, </span><span class="hl-0">block</span><span class="hl-1">.</span><span class="hl-6">attr</span><span class="hl-1">(</span><span class="hl-3">&#39;attrName&#39;</span><span class="hl-1">), </span><span class="hl-3">&#39;c&#39;</span><span class="hl-1">),</span><br/><span class="hl-1">  </span><span class="hl-7">functionElement</span><span class="hl-1">: </span><span class="hl-6">fn</span><span class="hl-1">(</span><span class="hl-3">&#39;tolist&#39;</span><span class="hl-1">, [</span><span class="hl-3">&#39;a&#39;</span><span class="hl-1">, </span><span class="hl-3">&#39;b&#39;</span><span class="hl-1">, </span><span class="hl-3">&#39;c&#39;</span><span class="hl-1">]).</span><span class="hl-6">element</span><span class="hl-1">(</span><span class="hl-8">0</span><span class="hl-1">),</span><br/><span class="hl-1">  </span><span class="hl-7">custom</span><span class="hl-1">: </span><span class="hl-6">arg</span><span class="hl-1">(</span><span class="hl-3">&#39;max(5, 12, 9)&#39;</span><span class="hl-1">),</span><br/><span class="hl-1">  </span><span class="hl-7">interpolation</span><span class="hl-1">: </span><span class="hl-3">`str-</span><span class="hl-4">${</span><span class="hl-0">block</span><span class="hl-9">.</span><span class="hl-6">attr</span><span class="hl-9">(</span><span class="hl-3">&#39;attrName&#39;</span><span class="hl-9">)</span><span class="hl-4">}</span><span class="hl-3">`</span><br/><span class="hl-1">}</span>
</code></pre>

<a href="#attributes" id="attributes" style="color: inherit; text-decoration: none;">
  <h3><strong>Attributes</strong></h3>
</a>
<pre><code class="language-javascript"><span class="hl-0">block</span><span class="hl-1">.</span><span class="hl-6">attr</span><span class="hl-1">(</span><span class="hl-3">&#39;id&#39;</span><span class="hl-1">)                                      </span><span class="hl-10">// block id, string</span><br/><span class="hl-0">block</span><span class="hl-1">.</span><span class="hl-0">id</span><span class="hl-1">                                              </span><span class="hl-10">// convenience getter function, same as attr(&#39;id&#39;)</span><br/><span class="hl-0">block</span><span class="hl-1">.</span><span class="hl-6">attr</span><span class="hl-1">(</span><span class="hl-3">&#39;subnets&#39;</span><span class="hl-1">)                                 </span><span class="hl-10">// subnet objects, object list</span><br/><span class="hl-0">block</span><span class="hl-1">.</span><span class="hl-6">attr</span><span class="hl-1">(</span><span class="hl-3">&#39;subnets.*.id&#39;</span><span class="hl-1">)                            </span><span class="hl-10">// subnet ids, string list</span><br/><span class="hl-0">block</span><span class="hl-1">.</span><span class="hl-6">attr</span><span class="hl-1">(</span><span class="hl-3">&#39;subnets&#39;</span><span class="hl-1">).</span><span class="hl-6">attr</span><span class="hl-1">(</span><span class="hl-3">&#39;*&#39;</span><span class="hl-1">).</span><span class="hl-6">attr</span><span class="hl-1">(</span><span class="hl-3">&#39;id&#39;</span><span class="hl-1">)            </span><span class="hl-10">// same as above</span><br/><span class="hl-0">block</span><span class="hl-1">.</span><span class="hl-6">attr</span><span class="hl-1">(</span><span class="hl-3">&#39;subnets.*.id[0]&#39;</span><span class="hl-1">)                         </span><span class="hl-10">// first subnet id, string</span><br/><span class="hl-0">block</span><span class="hl-1">.</span><span class="hl-6">attr</span><span class="hl-1">(</span><span class="hl-3">&#39;subnets&#39;</span><span class="hl-1">).</span><span class="hl-6">attr</span><span class="hl-1">(</span><span class="hl-3">&#39;*&#39;</span><span class="hl-1">).</span><span class="hl-6">attr</span><span class="hl-1">(</span><span class="hl-3">&#39;id&#39;</span><span class="hl-1">).</span><span class="hl-6">element</span><span class="hl-1">(</span><span class="hl-8">0</span><span class="hl-1">) </span><span class="hl-10">// same as above</span>
</code></pre>

<a href="#variables" id="variables" style="color: inherit; text-decoration: none;">
  <h3><strong>Variables</strong></h3>
</a>
<pre><code class="language-javascript"><span class="hl-10">// You can directly add multiple variable values.</span><br/><span class="hl-0">tfg</span><span class="hl-1">.</span><span class="hl-6">addVars</span><span class="hl-1">({</span><br/><span class="hl-1">  </span><span class="hl-0">var1:</span><span class="hl-1"> </span><span class="hl-8">123</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-0">var2:</span><span class="hl-1"> </span><span class="hl-3">&#39;abc&#39;</span><br/><span class="hl-1">});</span><br/><br/><span class="hl-10">// You can also add single variable value while adding variable block to your configuration.</span><br/><span class="hl-0">tfg</span><span class="hl-1">.</span><span class="hl-6">variable</span><span class="hl-1">(</span><span class="hl-3">&#39;password&#39;</span><span class="hl-1">, {</span><br/><span class="hl-1">  </span><span class="hl-0">type:</span><span class="hl-1"> </span><span class="hl-3">&#39;string&#39;</span><br/><span class="hl-1">}, </span><span class="hl-3">&#39;p@ssW0rd&#39;</span><span class="hl-1">);</span>
</code></pre>

<a href="#merge-multiple-configurations" id="merge-multiple-configurations" style="color: inherit; text-decoration: none;">
  <h3><strong>Merge multiple configurations</strong></h3>
</a>
<pre><code class="language-javascript"><span class="hl-10">// You can split your configuration into multiple files and merge them before you generate the final outcome.</span><br/><span class="hl-0">tfg</span><span class="hl-1">.</span><span class="hl-6">merge</span><span class="hl-1">(</span><span class="hl-0">tfg2</span><span class="hl-1">, </span><span class="hl-0">tfg3</span><span class="hl-1">);</span>
</code></pre>

<a href="#generate-terraform-configuration" id="generate-terraform-configuration" style="color: inherit; text-decoration: none;">
  <h3><strong>Generate Terraform configuration</strong></h3>
</a>
<pre><code class="language-javascript"><span class="hl-10">// Generate Terraform configuration as string</span><br/><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-5">result</span><span class="hl-1"> = </span><span class="hl-0">tfg</span><span class="hl-1">.</span><span class="hl-6">generate</span><span class="hl-1">();</span><br/><span class="hl-0">console</span><span class="hl-1">.</span><span class="hl-6">log</span><span class="hl-1">(</span><span class="hl-0">result</span><span class="hl-1">.</span><span class="hl-0">tf</span><span class="hl-1">);</span><br/><span class="hl-0">console</span><span class="hl-1">.</span><span class="hl-6">log</span><span class="hl-1">(</span><span class="hl-0">result</span><span class="hl-1">.</span><span class="hl-0">tfvars</span><span class="hl-1">);</span><br/><br/><span class="hl-10">// Write Terraform configuration to a file</span><br/><span class="hl-0">tfg</span><span class="hl-1">.</span><span class="hl-6">write</span><span class="hl-1">({</span><br/><span class="hl-1">  </span><span class="hl-0">dir:</span><span class="hl-1"> </span><span class="hl-3">&#39;outputDir&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-0">format:</span><span class="hl-1"> </span><span class="hl-4">true</span><br/><span class="hl-1">});</span>
</code></pre>

<a href="#example" id="example" style="color: inherit; text-decoration: none;">
  <h2><strong>Example</strong></h2>
</a>
<pre><code class="language-javascript"><span class="hl-2">import</span><span class="hl-1"> </span><span class="hl-0">TerraformGenerator</span><span class="hl-1">, { </span><span class="hl-0">Map</span><span class="hl-1">, </span><span class="hl-0">map</span><span class="hl-1"> } </span><span class="hl-2">from</span><span class="hl-1"> </span><span class="hl-3">&#39;terraform-generator&#39;</span><span class="hl-1">;</span><br/><span class="hl-2">import</span><span class="hl-1"> </span><span class="hl-0">path</span><span class="hl-1"> </span><span class="hl-2">from</span><span class="hl-1"> </span><span class="hl-3">&#39;path&#39;</span><span class="hl-1">;</span><br/><br/><span class="hl-10">// Constants</span><br/><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-5">project</span><span class="hl-1"> = </span><span class="hl-3">&#39;example&#39;</span><span class="hl-1">;</span><br/><br/><span class="hl-10">// Environment variables</span><br/><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-5">configs</span><span class="hl-1"> = {</span><br/><span class="hl-1">  </span><span class="hl-0">env:</span><span class="hl-1"> </span><span class="hl-3">&#39;dev&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-0">tiers:</span><span class="hl-1"> [</span><br/><span class="hl-1">    {</span><br/><span class="hl-1">      </span><span class="hl-0">name:</span><span class="hl-1"> </span><span class="hl-3">&#39;web&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">      </span><span class="hl-0">cidr:</span><span class="hl-1"> </span><span class="hl-3">&#39;172.88.100.0/22&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">      </span><span class="hl-0">subnetCidrs:</span><span class="hl-1"> [</span><span class="hl-3">&#39;172.88.100.0/24&#39;</span><span class="hl-1">, </span><span class="hl-3">&#39;172.88.101.0/24&#39;</span><span class="hl-1">, </span><span class="hl-3">&#39;172.88.102.0/24&#39;</span><span class="hl-1">]</span><br/><span class="hl-1">    },</span><br/><span class="hl-1">    {</span><br/><span class="hl-1">      </span><span class="hl-0">name:</span><span class="hl-1"> </span><span class="hl-3">&#39;app&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">      </span><span class="hl-0">cidr:</span><span class="hl-1"> </span><span class="hl-3">&#39;172.88.104.0/22&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">      </span><span class="hl-0">subnetCidrs:</span><span class="hl-1"> [</span><span class="hl-3">&#39;172.88.104.0/24&#39;</span><span class="hl-1">, </span><span class="hl-3">&#39;172.88.105.0/24&#39;</span><span class="hl-1">, </span><span class="hl-3">&#39;172.88.106.0/24&#39;</span><span class="hl-1">]</span><br/><span class="hl-1">    },</span><br/><span class="hl-1">    {</span><br/><span class="hl-1">      </span><span class="hl-0">name:</span><span class="hl-1"> </span><span class="hl-3">&#39;db&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">      </span><span class="hl-0">cidr:</span><span class="hl-1"> </span><span class="hl-3">&#39;172.88.108.0/22&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">      </span><span class="hl-0">subnetCidrs:</span><span class="hl-1"> [</span><span class="hl-3">&#39;172.88.108.0/24&#39;</span><span class="hl-1">, </span><span class="hl-3">&#39;172.88.109.0/24&#39;</span><span class="hl-1">, </span><span class="hl-3">&#39;172.88.110.0/24&#39;</span><span class="hl-1">]</span><br/><span class="hl-1">    }</span><br/><span class="hl-1">  ]</span><br/><span class="hl-1">};</span><br/><br/><span class="hl-10">// Utility functions</span><br/><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-6">getAvailabilityZone</span><span class="hl-1"> = (</span><span class="hl-0">i</span><span class="hl-1">: </span><span class="hl-11">number</span><span class="hl-1">): </span><span class="hl-11">string</span><span class="hl-1"> </span><span class="hl-4">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">  </span><span class="hl-2">if</span><span class="hl-1"> (</span><span class="hl-0">i</span><span class="hl-1"> === </span><span class="hl-8">0</span><span class="hl-1">) {</span><br/><span class="hl-1">    </span><span class="hl-2">return</span><span class="hl-1"> </span><span class="hl-3">&#39;ap-southeast-1a&#39;</span><span class="hl-1">;</span><br/><span class="hl-1">  } </span><span class="hl-2">else</span><span class="hl-1"> </span><span class="hl-2">if</span><span class="hl-1"> (</span><span class="hl-0">i</span><span class="hl-1"> === </span><span class="hl-8">1</span><span class="hl-1">) {</span><br/><span class="hl-1">    </span><span class="hl-2">return</span><span class="hl-1"> </span><span class="hl-3">&#39;ap-southeast-1b&#39;</span><span class="hl-1">;</span><br/><span class="hl-1">  } </span><span class="hl-2">else</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-2">return</span><span class="hl-1"> </span><span class="hl-3">&#39;ap-southeast-1c&#39;</span><span class="hl-1">;</span><br/><span class="hl-1">  }</span><br/><span class="hl-1">};</span><br/><br/><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-6">getTagName</span><span class="hl-1"> = (</span><span class="hl-0">type</span><span class="hl-1">: </span><span class="hl-11">string</span><span class="hl-1">, </span><span class="hl-0">name</span><span class="hl-1">?: </span><span class="hl-11">string</span><span class="hl-1">): </span><span class="hl-11">string</span><span class="hl-1"> </span><span class="hl-4">=&gt;</span><br/><span class="hl-1">  </span><span class="hl-3">`</span><span class="hl-4">${</span><span class="hl-0">type</span><span class="hl-4">}</span><span class="hl-3">-</span><span class="hl-4">${</span><span class="hl-0">project</span><span class="hl-4">}</span><span class="hl-3">-</span><span class="hl-4">${</span><span class="hl-0">configs</span><span class="hl-9">.</span><span class="hl-0">env</span><span class="hl-4">}${</span><span class="hl-0">name</span><span class="hl-9"> </span><span class="hl-1">?</span><span class="hl-9"> </span><span class="hl-3">`-</span><span class="hl-4">${</span><span class="hl-0">name</span><span class="hl-4">}</span><span class="hl-3">`</span><span class="hl-9"> </span><span class="hl-1">:</span><span class="hl-9"> </span><span class="hl-3">&#39;&#39;</span><span class="hl-4">}</span><span class="hl-3">`</span><span class="hl-1">;</span><br/><br/><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-6">getTags</span><span class="hl-1"> = (</span><span class="hl-0">type</span><span class="hl-1">: </span><span class="hl-11">string</span><span class="hl-1">, </span><span class="hl-0">name</span><span class="hl-1">?: </span><span class="hl-11">string</span><span class="hl-1">): </span><span class="hl-11">Map</span><span class="hl-1"> </span><span class="hl-4">=&gt;</span><span class="hl-1"> </span><span class="hl-4">new</span><span class="hl-1"> </span><span class="hl-11">Map</span><span class="hl-1">({</span><br/><span class="hl-1">  </span><span class="hl-0">Name:</span><span class="hl-1"> </span><span class="hl-6">getTagName</span><span class="hl-1">(</span><span class="hl-0">type</span><span class="hl-1">, </span><span class="hl-0">name</span><span class="hl-1">),</span><br/><span class="hl-1">  </span><span class="hl-0">Project:</span><span class="hl-1"> </span><span class="hl-0">project</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-0">Env:</span><span class="hl-1"> </span><span class="hl-0">configs</span><span class="hl-1">.</span><span class="hl-0">env</span><br/><span class="hl-1">});</span><br/><br/><span class="hl-10">// Start writing Terraform configuration</span><br/><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-5">tfg</span><span class="hl-1"> = </span><span class="hl-4">new</span><span class="hl-1"> </span><span class="hl-6">TerraformGenerator</span><span class="hl-1">();</span><br/><br/><span class="hl-10">// Configure provider</span><br/><span class="hl-0">tfg</span><span class="hl-1">.</span><span class="hl-6">provider</span><span class="hl-1">(</span><span class="hl-3">&#39;aws&#39;</span><span class="hl-1">, {</span><br/><span class="hl-1">  </span><span class="hl-0">region:</span><span class="hl-1"> </span><span class="hl-3">&#39;ap-southeast-1&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-0">profile:</span><span class="hl-1"> </span><span class="hl-3">&#39;example&#39;</span><br/><span class="hl-1">});</span><br/><br/><span class="hl-10">// Find VPC by name</span><br/><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-5">vpc</span><span class="hl-1"> = </span><span class="hl-0">tfg</span><span class="hl-1">.</span><span class="hl-6">data</span><span class="hl-1">(</span><span class="hl-3">&#39;aws_vpc&#39;</span><span class="hl-1">, </span><span class="hl-3">&#39;vpc&#39;</span><span class="hl-1">, {</span><br/><span class="hl-1">  </span><span class="hl-0">filter:</span><span class="hl-1"> [{</span><br/><span class="hl-1">    </span><span class="hl-0">name:</span><span class="hl-1"> </span><span class="hl-3">&#39;tag:Name&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">    </span><span class="hl-0">values:</span><span class="hl-1"> [</span><span class="hl-6">getTagName</span><span class="hl-1">(</span><span class="hl-3">&#39;vpc&#39;</span><span class="hl-1">)]</span><br/><span class="hl-1">  }]</span><br/><span class="hl-1">});</span><br/><br/><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-5">subnets</span><span class="hl-1"> = {</span><br/><span class="hl-1">  </span><span class="hl-0">web:</span><span class="hl-1"> [],</span><br/><span class="hl-1">  </span><span class="hl-0">app:</span><span class="hl-1"> [],</span><br/><span class="hl-1">  </span><span class="hl-0">db:</span><span class="hl-1"> []</span><br/><span class="hl-1">};</span><br/><br/><span class="hl-10">// Create 3-tiers, each tier has 3 subnets spread across availabilty zones</span><br/><span class="hl-0">configs</span><span class="hl-1">.</span><span class="hl-0">tiers</span><span class="hl-1">.</span><span class="hl-6">forEach</span><span class="hl-1">(</span><span class="hl-0">tier</span><span class="hl-1"> </span><span class="hl-4">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">  </span><span class="hl-0">tier</span><span class="hl-1">.</span><span class="hl-0">subnetCidrs</span><span class="hl-1">.</span><span class="hl-6">forEach</span><span class="hl-1">((</span><span class="hl-0">cidr</span><span class="hl-1">, </span><span class="hl-0">i</span><span class="hl-1">) </span><span class="hl-4">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-5">name</span><span class="hl-1"> = </span><span class="hl-3">`</span><span class="hl-4">${</span><span class="hl-0">tier</span><span class="hl-9">.</span><span class="hl-0">name</span><span class="hl-4">}${</span><span class="hl-0">i</span><span class="hl-4">}</span><span class="hl-3">`</span><span class="hl-1">;</span><br/><span class="hl-1">    </span><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-5">subnet</span><span class="hl-1"> = </span><span class="hl-0">tfg</span><span class="hl-1">.</span><span class="hl-6">resource</span><span class="hl-1">(</span><span class="hl-3">&#39;aws_subnet&#39;</span><span class="hl-1">, </span><span class="hl-3">`subnet_</span><span class="hl-4">${</span><span class="hl-0">name</span><span class="hl-4">}</span><span class="hl-3">`</span><span class="hl-1">, {</span><br/><span class="hl-1">      </span><span class="hl-0">vpc_id:</span><span class="hl-1"> </span><span class="hl-0">vpc</span><span class="hl-1">.</span><span class="hl-0">id</span><span class="hl-1">,</span><br/><span class="hl-1">      </span><span class="hl-0">cidr_block:</span><span class="hl-1"> </span><span class="hl-0">cidr</span><span class="hl-1">,</span><br/><span class="hl-1">      </span><span class="hl-0">availability_zone:</span><span class="hl-1"> </span><span class="hl-6">getAvailabilityZone</span><span class="hl-1">(</span><span class="hl-0">i</span><span class="hl-1">),</span><br/><span class="hl-1">      </span><span class="hl-0">tags:</span><span class="hl-1"> </span><span class="hl-6">getTags</span><span class="hl-1">(</span><span class="hl-3">&#39;subnet&#39;</span><span class="hl-1">, </span><span class="hl-0">name</span><span class="hl-1">)</span><br/><span class="hl-1">    });</span><br/><span class="hl-1">    </span><span class="hl-0">subnets</span><span class="hl-1">[</span><span class="hl-0">tier</span><span class="hl-1">.</span><span class="hl-0">name</span><span class="hl-1">].</span><span class="hl-6">push</span><span class="hl-1">(</span><span class="hl-0">subnet</span><span class="hl-1">);</span><br/><span class="hl-1">  });</span><br/><span class="hl-1">});</span><br/><br/><span class="hl-10">// Output all subnet ids</span><br/><span class="hl-0">tfg</span><span class="hl-1">.</span><span class="hl-6">output</span><span class="hl-1">(</span><span class="hl-3">&#39;subnets&#39;</span><span class="hl-1">, {</span><br/><span class="hl-1">  </span><span class="hl-0">value:</span><span class="hl-1"> </span><span class="hl-6">map</span><span class="hl-1">({</span><br/><span class="hl-1">    </span><span class="hl-0">webSubnets:</span><span class="hl-1"> </span><span class="hl-0">subnets</span><span class="hl-1">.</span><span class="hl-0">web</span><span class="hl-1">.</span><span class="hl-6">map</span><span class="hl-1">(</span><span class="hl-0">subnet</span><span class="hl-1"> </span><span class="hl-4">=&gt;</span><span class="hl-1"> </span><span class="hl-0">subnet</span><span class="hl-1">.</span><span class="hl-0">id</span><span class="hl-1">),</span><br/><span class="hl-1">    </span><span class="hl-0">appSubnets:</span><span class="hl-1"> </span><span class="hl-0">subnets</span><span class="hl-1">.</span><span class="hl-0">app</span><span class="hl-1">.</span><span class="hl-6">map</span><span class="hl-1">(</span><span class="hl-0">subnet</span><span class="hl-1"> </span><span class="hl-4">=&gt;</span><span class="hl-1"> </span><span class="hl-0">subnet</span><span class="hl-1">.</span><span class="hl-0">id</span><span class="hl-1">),</span><br/><span class="hl-1">    </span><span class="hl-0">dbSubnets:</span><span class="hl-1"> </span><span class="hl-0">subnets</span><span class="hl-1">.</span><span class="hl-0">db</span><span class="hl-1">.</span><span class="hl-6">map</span><span class="hl-1">(</span><span class="hl-0">subnet</span><span class="hl-1"> </span><span class="hl-4">=&gt;</span><span class="hl-1"> </span><span class="hl-0">subnet</span><span class="hl-1">.</span><span class="hl-0">id</span><span class="hl-1">)</span><br/><span class="hl-1">  })</span><br/><span class="hl-1">});</span><br/><br/><span class="hl-10">// Write the configuration into a terraform.tf file</span><br/><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-5">outputDir</span><span class="hl-1"> = </span><span class="hl-0">path</span><span class="hl-1">.</span><span class="hl-6">join</span><span class="hl-1">(</span><span class="hl-3">&#39;output&#39;</span><span class="hl-1">, </span><span class="hl-0">configs</span><span class="hl-1">.</span><span class="hl-0">env</span><span class="hl-1">, </span><span class="hl-3">&#39;subnets&#39;</span><span class="hl-1">);</span><br/><span class="hl-0">tfg</span><span class="hl-1">.</span><span class="hl-6">write</span><span class="hl-1">({ </span><span class="hl-0">dir:</span><span class="hl-1"> </span><span class="hl-0">outputDir</span><span class="hl-1">, </span><span class="hl-0">format:</span><span class="hl-1"> </span><span class="hl-4">true</span><span class="hl-1"> });</span>
</code></pre>
</div></div><div class="col-4 col-menu menu-sticky-wrap menu-highlight"><nav class="tsd-navigation primary"><ul><li class="current"><a href="modules.html">Exports</a></li></ul></nav><nav class="tsd-navigation secondary menu-sticky"><ul><li class="tsd-kind-class"><a href="classes/Argument.html" class="tsd-kind-icon">Argument</a></li><li class="tsd-kind-class"><a href="classes/Attribute.html" class="tsd-kind-icon">Attribute</a></li><li class="tsd-kind-class"><a href="classes/Backend.html" class="tsd-kind-icon">Backend</a></li><li class="tsd-kind-class"><a href="classes/Block.html" class="tsd-kind-icon">Block</a></li><li class="tsd-kind-class"><a href="classes/Comment.html" class="tsd-kind-icon">Comment</a></li><li class="tsd-kind-class"><a href="classes/Data.html" class="tsd-kind-icon">Data</a></li><li class="tsd-kind-class"><a href="classes/Function.html" class="tsd-kind-icon">Function</a></li><li class="tsd-kind-class"><a href="classes/Heredoc.html" class="tsd-kind-icon">Heredoc</a></li><li class="tsd-kind-class"><a href="classes/List.html" class="tsd-kind-icon">List</a></li><li class="tsd-kind-class"><a href="classes/Locals.html" class="tsd-kind-icon">Locals</a></li><li class="tsd-kind-class"><a href="classes/Map.html" class="tsd-kind-icon">Map</a></li><li class="tsd-kind-class"><a href="classes/Module.html" class="tsd-kind-icon">Module</a></li><li class="tsd-kind-class"><a href="classes/Output.html" class="tsd-kind-icon">Output</a></li><li class="tsd-kind-class"><a href="classes/Provider.html" class="tsd-kind-icon">Provider</a></li><li class="tsd-kind-class"><a href="classes/Provisioner.html" class="tsd-kind-icon">Provisioner</a></li><li class="tsd-kind-class"><a href="classes/Resource.html" class="tsd-kind-icon">Resource</a></li><li class="tsd-kind-class"><a href="classes/TerraformGenerator.html" class="tsd-kind-icon">Terraform<wbr/>Generator</a></li><li class="tsd-kind-class"><a href="classes/Variable.html" class="tsd-kind-icon">Variable</a></li><li class="tsd-kind-interface"><a href="interfaces/ResourceToDataOptions.html" class="tsd-kind-icon">Resource<wbr/>To<wbr/>Data<wbr/>Options</a></li><li class="tsd-kind-interface"><a href="interfaces/WriteOptions.html" class="tsd-kind-icon">Write<wbr/>Options</a></li><li class="tsd-kind-function"><a href="modules.html#arg" class="tsd-kind-icon">arg</a></li><li class="tsd-kind-function"><a href="modules.html#attr" class="tsd-kind-icon">attr</a></li><li class="tsd-kind-function"><a href="modules.html#fn" class="tsd-kind-icon">fn</a></li><li class="tsd-kind-function"><a href="modules.html#heredoc" class="tsd-kind-icon">heredoc</a></li><li class="tsd-kind-function"><a href="modules.html#list" class="tsd-kind-icon">list</a></li><li class="tsd-kind-function"><a href="modules.html#map" class="tsd-kind-icon">map</a></li></ul></nav></div></div></div><footer class=""><div class="container"><h2>Legend</h2><div class="tsd-legend-group"><ul class="tsd-legend"><li class="tsd-kind-constructor tsd-parent-kind-class"><span class="tsd-kind-icon">Constructor</span></li><li class="tsd-kind-property tsd-parent-kind-class"><span class="tsd-kind-icon">Property</span></li><li class="tsd-kind-method tsd-parent-kind-class"><span class="tsd-kind-icon">Method</span></li></ul><ul class="tsd-legend"><li class="tsd-kind-property tsd-parent-kind-class tsd-is-inherited"><span class="tsd-kind-icon">Inherited property</span></li><li class="tsd-kind-method tsd-parent-kind-class tsd-is-inherited"><span class="tsd-kind-icon">Inherited method</span></li></ul><ul class="tsd-legend"><li class="tsd-kind-property tsd-parent-kind-interface"><span class="tsd-kind-icon">Property</span></li></ul><ul class="tsd-legend"><li class="tsd-kind-method tsd-parent-kind-class tsd-is-protected"><span class="tsd-kind-icon">Protected method</span></li></ul></div><h2>Settings</h2><p>Theme <select id="theme"><option value="os">OS</option><option value="light">Light</option><option value="dark">Dark</option></select></p></div></footer><div class="overlay"></div><script src="assets/main.js"></script></body></html>